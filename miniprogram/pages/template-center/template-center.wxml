<!--pages/template-center/template-center.wxml-->
<view class="container">
  <!-- 头部导航 -->
  <view class="header">
    <view class="header-left" bindtap="goBack">
      <icon name="arrow-left" size="20" color="#FFFFFF"></icon>
    </view>
    <view class="header-title">
      <text>模板中心</text>
    </view>
    <view class="header-right">
      <view class="view-toggle">
        <view class="toggle-btn {{viewMode === 'grid' ? 'active' : ''}}" bindtap="switchViewMode" data-mode="grid">
          <icon name="grid" size="16" color="{{viewMode === 'grid' ? '#FFFFFF' : '#CBD5E1'}}"></icon>
        </view>
        <view class="toggle-btn {{viewMode === 'list' ? 'active' : ''}}" bindtap="switchViewMode" data-mode="list">
          <icon name="list" size="16" color="{{viewMode === 'list' ? '#FFFFFF' : '#CBD5E1'}}"></icon>
        </view>
      </view>
    </view>
  </view>

  <!-- 搜索栏 -->
  <view class="search-section">
    <view class="search-bar">
      <icon name="search" size="16" color="#64748B"></icon>
      <input 
        class="search-input" 
        placeholder="搜索模板..." 
        value="{{searchKeyword}}"
        bindinput="onSearch"
      />
    </view>
  </view>

  <!-- 分类筛选 -->
  <view class="category-section">
    <scroll-view class="category-scroll" scroll-x="true">
      <view class="category-list">
        <view 
          class="category-item {{selectedCategory === item.id ? 'active' : ''}}"
          wx:for="{{categories}}" 
          wx:key="id"
          bindtap="onCategoryFilter"
          data-category="{{item.id}}"
        >
          <icon name="{{item.icon}}" size="16" color="{{selectedCategory === item.id ? '#FFFFFF' : '#64748B'}}"></icon>
          <text>{{item.name}}</text>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- 模板列表 -->
  <view class="template-list {{viewMode}}">
    <view 
      class="template-card"
      wx:for="{{templates}}" 
      wx:key="id"
    >
      <!-- 模板预览图 -->
      <view class="template-preview">
        <image class="preview-image" src="{{item.preview}}" mode="aspectFill"></image>
        <view class="template-overlay">
          <view class="template-actions">
            <view class="action-btn preview" bindtap="previewTemplate" data-id="{{item.id}}">
              <icon name="eye" size="14" color="#FFFFFF"></icon>
              <text>预览</text>
            </view>
            <view class="action-btn use" bindtap="useTemplate" data-id="{{item.id}}">
              <icon name="plus" size="14" color="#FFFFFF"></icon>
              <text>使用</text>
            </view>
          </view>
        </view>
      </view>

      <!-- 模板信息 -->
      <view class="template-info">
        <view class="template-header">
          <text class="template-title">{{item.title}}</text>
          <view class="template-rating">
            <icon name="star" size="12" color="#F59E0B"></icon>
            <text>{{item.rating}}</text>
          </view>
        </view>
        
        <text class="template-desc">{{item.description}}</text>
        
        <view class="template-tags">
          <view 
            class="tag-item"
            wx:for="{{item.tags}}" 
            wx:key="*this"
            wx:for-item="tag"
          >
            <text>{{tag}}</text>
          </view>
        </view>
        
        <view class="template-meta">
          <view class="meta-item">
            <icon name="user" size="12" color="#64748B"></icon>
            <text>{{item.author}}</text>
          </view>
          <view class="meta-item">
            <icon name="download" size="12" color="#64748B"></icon>
            <text>{{item.usageCount}}次使用</text>
          </view>
        </view>
      </view>

      <!-- 操作按钮 -->
      <view class="template-actions-bottom">
        <view class="action-item" bindtap="toggleFavorite" data-id="{{item.id}}">
          <icon name="{{item.isFavorite ? 'heart-filled' : 'heart'}}" size="16" color="{{item.isFavorite ? '#EF4444' : '#64748B'}}"></icon>
        </view>
        <view class="action-item" bindtap="shareTemplate" data-id="{{item.id}}">
          <icon name="share" size="16" color="#64748B"></icon>
        </view>
      </view>
    </view>
  </view>

  <!-- 空状态 -->
  <view wx:if="{{templates.length === 0 && !loading}}" class="empty-state">
    <view class="empty-icon">
      <icon name="document-center" size="64" color="#CBD5E1"></icon>
    </view>
    <view class="empty-content">
      <text class="empty-title">暂无模板</text>
      <text class="empty-desc">没有找到符合条件的模板</text>
    </view>
  </view>

  <!-- 加载状态 -->
  <view wx:if="{{loading}}" class="loading-state">
    <view class="loading-spinner"></view>
    <text class="loading-text">加载中...</text>
  </view>
</view>
